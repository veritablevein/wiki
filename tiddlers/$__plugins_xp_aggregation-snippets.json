{"tiddlers":{"$:/xp/ui/Actions/new-snippet":{"title":"$:/xp/ui/Actions/new-snippet","description":"create a snippet","tags":"$:/tags/Actions","text":"\\define get-tags() $(textFieldTags)$\n\\define get-text() $(textField)$\n<$vars textFieldTags={{$:/config/new-snippet/Tags}} textField={{$:/config/new-snippet/Text}}>\n<$action-sendmessage\n\t$message=\"tm-new-tiddler\"\n\ttitle=<<now \"snippet/YYYY0MM0DD0hh0mm0ssXXX\">>\n\ttags=<<get-tags>>\n\ttext=<<get-text>>\n\tcaption=\"snippets\"\n/>\n</$vars>\n"},"$:/xp/ui/Buttons/new-snippet":{"title":"$:/xp/ui/Buttons/new-snippet","caption":"{{$:/core/images/new-button}} new snippet","description":"Create a snippet","text":"\\whitespace trim\n\\define newsnippetButton()\n<$button actions={{$:/xp/ui/Actions/new-snippet}} tooltip=\"Create a snippet\" aria-label=\"new snippet\" class=<<tv-config-toolbar-class>>>\n<$list filter=\"[<tv-config-toolbar-icons>match[yes]]\">\n{{$:/core/images/new-button}}\n</$list>\n<$list filter=\"[<tv-config-toolbar-text>match[yes]]\">\n<span class=\"tc-btn-text\"><$text text=\"new snippet\"/></span>\n</$list>\n</$button>\n\\end\n<<newsnippetButton>>\n"},"SNIPPETS":{"title":"SNIPPETS","caption":"{{$:/xp/images/wikitext}} SNIPPETS","color":"#bbb","icon":"$:/xp/images/wikitext","tmap.id":"814ad6af-a396-4dba-9da4-27d8eead4a7f","text":"\\import $:/aggregation/macros/general $:/snippets-macros\n\\whitespace trim\n\n\\define storeTitle() $:/temp/search/snippets\n\\define filterState() $:/state/filter/aggregation-snippets\n\\define readingMode() $:/config/xp/aggregation-snippets/ReadingMode\n\\define tocSwitchTid() $:/temp/xp/aggregation-snippets/aggregation-toc\n\\define SubStoryList() $:/temp/xp/aggregation-snippets/SubStoryList\n\\define SubHistoryList() $:/temp/xp/aggregation-snippets/SubHistoryList\n\n\\define filterPanel(filterState)\n<$wikify text=<<listTagsInUse>> name=\"tagsInUse\">\n<$list filter=\"[enlist<tagsInUse>limit[1]]\" variable=\"ignore\">\n<div class=\"xp-wrapper-aggrfilter\">\n<div class=\"xp-aggrfilter-category\" style=\"font-size:1em;padding:10px 0;\">\n<span class=\"xp-aggrfilter-category-item\">\n<$list filter=\"[enlist<tagsInUse>sort[]]\" variable=\"currentItem\">\n<$macrocall $name=\"aggrfilteritem\" item=<<currentItem>>/>\n</$list>\n<$macrocall $name=\"deselectButton\" filterState=<<filterState>>/>\n</span>\n</div>\n</div>\n</$list>\n</$wikify>\n\\end\n\n\\define alltagsfilter()\n<$vars L=\"tag[\" R=\"]\" lb=\"[\" rb={{{ [<configTiddler>get[text]removeprefix[[]] }}}>\n<$set filter=\"[list<filterState>addprefix<L>addsuffix<R>]+[join[]addprefix<lb>addsuffix<rb>addsuffix<sortRun>]\" name=\"alltags\" select=0>\n<$text text=<<alltags>>/>\n</$set>\n</$vars>\n\\end\n\n\\define cancel-search-actions() <$action-deletetiddler $filter=\"[<filterState>get[checktiddler]enlist-input[]]\"/><$action-deletetiddler $filter=\"[<storeTitle>] [<filterState>]\"/><$action-sendmessage $message=\"tm-focus-selector\" $param=\".xp-search-snippets input\"/>\n\n\\define newSnippetButton()\n<$button actions={{$:/xp/ui/Actions/new-snippet}} tooltip=\"Create a new snippet\" aria-label=\"new snippet\" class=\"tc-btn-invisible tc-btn-mini\">\n<span class=\"tc-btn-icon\">{{$:/core/images/new-button}}</span> new snippet\n</$button>\n\\end\n\n\\define navigatorNewSnippet()\n\\whitespace trim\n<$list filter=\"[<storeTitle>has[text]] [<filterState>has[list]] [<readingMode>get[text]match[on]] +[limit[1]]\" emptyMessage=\"\"\"<$navigator story=<<SubStoryList>> history=<<SubHistoryList>> openLinkFromInsideRiver=\"above\"><<newSnippetButton>></$navigator>\"\"\">\n<<newSnippetButton>>\n</$list>\n\\end\n\n\n<div class=\"tc-sidebar-lists xp-float-right\">\n<<navigatorNewSnippet>>&emsp;<<aggregationCount>>&emsp;<<help-button-to \"$:/snippets-help\" \"SNIPPETS Help\">>\n</div>\n\n<$list filter=\"[tag<aggregationTag>limit[1]]\" emptyMessage=\"{{$:/snippets-prompt}}\" variable=\"ignore\">\n\n<$navigator story=<<SubStoryList>> history=<<SubHistoryList>> openLinkFromInsideRiver=\"above\">\n\n<!-- Search Box -->\n<span class=\"xp-search xp-search-snippets\">\nSearch &#32; <$macrocall $name=\"selectSearchScope\" actions=<<snippets-select-actions>>/>  <i class='tc-small-gap-right'/> <$macrocall\n\t$name=\"keyboard-driven-input\"\n\ttiddler=<<storeTitle>>\n\ttype=\"search\"\n\ttag=\"input\"\n\tfocus=\"true\"\n\tinputCancelActions=<<cancel-search-actions>>\n/>\n</span>\n<i class='tc-tiny-gap-right'/>\n<$vars userInput={{{ [<storeTitle>get[text]] }}}\n\tresultCount=\"<$count filter='[subfilter<searchFilter>!has[draft.of]]'/>\"\n\tsortRun=\"+[!sort[created]]\">\n<$wikify text=\"<$macrocall $name='alltagsfilter' filterState=<<filterState>>/>\" name=\"alltagsfilterwikified\">\n<$set name=\"searchFilter\" filter=\"[<filterState>has[list]]\" value=<<alltagsfilterwikified>>\n\temptyValue={{{ [<configTiddler>get[text]addsuffix<sortRun>] }}}>\n<span class=\"tc-search\">\n<$list filter=\"[<storeTitle>!is[missing]get[text]!is[blank]] [<filterState>!is[missing]has[list]] +[limit[1]]\" variable=\"ignore\">\n<$button class=\"tc-btn-invisible\">\n<<cancel-search-actions>>\n{{$:/core/images/close-button}}\n</$button>\n</$list>\n<$macrocall $name=\"toggleReadingMode\" readingMode=<<readingMode>>/>\n<<tocSwitch>>\n<$reveal state=<<readingMode>> type=\"match\" text=\"on\" animate=\"yes\">\n<span class=\"xp-search-results\"><<lingo System/Matches>></span>\n</$reveal>\n</span>\n\n<!-- Filter Panel -->\n<$macrocall $name=\"filterPanel\" filterState=<<filterState>> />\n\n<$reveal state=<<readingMode>> type=\"nomatch\" text=\"on\" animate=\"yes\">\n\n<!-- Recent List -->\n<$reveal state=<<storeTitle>> type=\"match\" text=\"\">\n<$reveal stateTitle=<<filterState>> stateField=\"list\" type=\"match\" text=\"\">\n\n<div class=\"xp-search-results\">{{$:/language/ColourPicker/Recent}}</div>\n\n<div class=\"tc-link-info\">\n\n<$list\n\tfilter=\"[list<SubStoryList>!tag<aggregationTag>] [tag<aggregationTag>!sort[created]limit[5]] -[tag<aggregationTag>is[draft]get[draft.title]]\"\n\thistory=<<SubHistoryList>>\n\ttemplate=\"$:/templates/transclusion-snippet\"\n\teditTemplate={{$:/config/ui/EditTemplate}} \n\tstoryview=\"pop\"\n/>\n\n</div>\n</$reveal>\n</$reveal>\n\n<!-- Result List -->\n<$list filter=\"[<storeTitle>has[text]] [<filterState>has[list]] +[limit[1]]\" variable=\"ignore\">\n<$set name=\"listFilter\" filter=\"[<storeTitle>has[text]] [<filterState>has[list]] +[limit[1]]\"\n\tvalue=\"[subfilter<searchFilter>] -[subfilter<searchFilter>is[draft]get[draft.title]]\"\n\temptyValue=\"[list<SubStoryList>] [subfilter<searchFilter>] -[subfilter<searchFilter>is[draft]get[draft.title]]\">\n\n<div class=\"xp-search-results\"><<lingo System/Matches>></div>\n\n<div class=\"tc-link-info\">\n\n<$list\n\tfilter=<<listFilter>>\n\thistory=<<SubHistoryList>>\n\ttemplate=\"$:/templates/transclusion-snippet\"\n\teditTemplate={{$:/config/ui/EditTemplate}}\n\tstoryview=\"pop\"\n/>\n\n</div>\n\n</$set>\n</$list><!-- Result List -->\n</$reveal>\n\n</$set></$wikify></$vars>\n</$navigator>\n\n<!-- Reading Mode -->\n<$vars userInput={{{ [<storeTitle>get[text]] }}}\n\tresultCount=\"<$count filter='[subfilter<searchFilter>!has[draft.of]]'/>\"\n\tsortRun=\"+[!sort[created]]\">\n<$wikify text=\"<$macrocall $name='alltagsfilter' filterState=<<filterState>>/>\" name=\"alltagsfilterwikified\">\n<$set name=\"searchFilter\" filter=\"[<filterState>has[list]]\" value=<<alltagsfilterwikified>>\n\temptyValue={{{ [<configTiddler>get[text]addsuffix<sortRun>] }}}>\n<$reveal state=<<readingMode>> type=\"match\" text=\"on\" animate=\"yes\">\n<$list filter=\"[subfilter<searchFilter>limit[1]]\" variable=\"ignore\">\n\n<$macrocall\n\t$name=\"aggregation-toc\"\n\tfilter=\"[subfilter<searchFilter>!has[draft.of]]\"\n\tselectedTiddler=\"$:/temp/toc/selectedTiddler/aggregation-snippets\"\n\ttocSwitchTid=<<tocSwitchTid>>\n/>\n\n</$list>\n</$reveal>\n</$set></$wikify></$vars>\n\n</$list>\n"},"$:/config/xp/aggregation-snippets/ReadingMode":{"title":"$:/config/xp/aggregation-snippets/ReadingMode","text":"off"},"$:/config/new-snippet/Tags":{"title":"$:/config/new-snippet/Tags","text":"Snippet"},"$:/config/new-snippet/Text":{"title":"$:/config/new-snippet/Text","text":"<<codes src:\n\"\"\"\n\"\"\">>"},"$:/config/xp/aggregation/ui/snippets":{"title":"$:/config/xp/aggregation/ui/snippets","text":"SNIPPETS"},"$:/xp/images/wikitext":{"title":"$:/xp/images/wikitext","tags":"$:/tags/Image","text":"<svg width=\"22pt\" height=\"22pt\" viewBox=\"0 0 1024 1024\"><path fill-rule=\"evenodd\" d=\"M127.758244 383.101281h63.815421v-63.814398h-63.495126V64.024176H63.622528v255.262707h64.135716zM191.856098 64.024176h63.815421v255.262707h-63.815421zM319.769372 64.024176h63.815422v255.262707h-63.815422zM255.671519 319.286883h63.815421v63.814398h-63.815421zM448.996572 62.385862h63.816445v63.815422h-63.816445zM448.996572 191.655018h63.816445v191.446263h-63.816445zM640.435673 255.470439h63.814397v-63.815421h-63.814397V64.024176h-63.817468v319.077105h63.817468zM704.25007 255.470439h63.816445v63.816444h-63.816445zM768.066515 319.286883h63.814398v63.814398H768.066515zM768.066515 127.838573h63.815421V64.024176H768.066515v62.177108h-63.816445v63.816444h63.816445zM896.560004 64.024176h63.816445v63.814397h-63.816445zM896.560004 191.655018h63.816445v191.446263h-63.816445zM63.622528 961.614138h896.753921V447.367981H63.622528V961.614138z m512.997723-385.068076h319.077106v320.625368h-63.816444V704.419428H768.066515v63.572897h-63.814398v-63.814398h63.814398v-63.814397H576.620251v-63.817468z m-0.002046 256.809947h63.816444v-63.814398h63.814398v63.814398h-63.814398v63.814397h-63.816444v-63.814397z m-448.719768-256.809947h255.544117v63.816444H127.898437v-63.816444z m0 127.630842h255.54514v63.816445H127.898437v-63.816445z m0 129.178081h127.913275v63.816445h-127.913275v-63.816445z\"/></svg>"},"$:/snippets-help":{"title":"$:/snippets-help","color":"#bbb","icon":"$:/core/images/help","text":"\\define hidePrefixText()\n\\whitespace trim\n<h2 class=\"tc-title\">\n<$text text={{{ [<currentTiddler>removeprefix[snippet/]] }}}/>\n</h2>\n\\end\n\n<div class=\"blue-box\">\n\n''SNIPPETS 的用途：''记录自己常用的维基文本（WikiText）代码片段。\n\n</div>\n\n! 为什么要使用 SNIPPETS？\n\n默认的图章按钮无法管理大量的文本片段，所以 SNIPPETS 试图解决这个问题。SNIPPETS 将代码片段可视化，并通过搜索和标签过滤，进行快速查找。\n\n\n! 如何使用？\n\n# 点击按钮 <span class=\"tc-btn-icon\">{{$:/core/images/new-button}}</span> new snippet 创建条目。<div class=\"gray-box\">\n\n使用 `codes` 宏生成一个带复制按钮的代码片段，可以高亮代码。比如：`<<codes js src:\"\"\"text\"\"\">>`。\n\n在阅读模式下可以查阅所有条目。\n\n</div>\n\n# 星标条目。<div class=\"gray-box\">\n\n常用的条目，可以打上标签 `Star`，卡片会有特殊标记。\n\n</div>\n\n# 参考其他帮助说明：[[Aggregation Readme|$:/plugins/xp/aggregation]] / [[Bookshelf Help|$:/bookshelf-help]]\n\n\n! 设置\n\n预设为故事河中优先显示 Caption，见 $:/aggregation/ShowCaption。你可以通过下面按钮切换。\n\n<$vars configTiddler=\"$:/tags/ViewTemplateTitleFilter\" before-title=\"$:/config/ViewTemplateTitleFilters/default\">\n\n<$button>\n<$list filter=\"[<configTiddler>!contains[$:/config/ViewTemplateTitleFilters/snippet]]\" variable=\"ignore\">\nShow caption\n<$action-listops $tiddler=<<configTiddler>> $subfilter=\"+[insertbefore:before-title[$:/config/ViewTemplateTitleFilters/snippet]]\"/>\n</$list>\n<$list filter=\"[<configTiddler>contains[$:/config/ViewTemplateTitleFilters/snippet]]\" variable=\"ignore\">\nShow title\n<$action-listops $tiddler=<<configTiddler>> $subfilter=\"-$:/config/ViewTemplateTitleFilters/snippet\"/>\n</$list>\n</$button>\n\n</$vars>"},"$:/snippets-macros":{"title":"$:/snippets-macros","tags":"$:/tags/Macro/Aggregation","text":"\\define aggregationTag() Snippet\n\\define uiTitle()        $:/config/xp/aggregation/ui/snippets\n\n<pre><$view field=\"text\"/></pre>"},"$:/snippets-prompt":{"title":"$:/snippets-prompt","text":"{{$:/aggregation/prompt}}"},"$:/config/ViewTemplateTitleFilters/snippet":{"title":"$:/config/ViewTemplateTitleFilters/snippet","tags":"$:/tags/ViewTemplateTitleFilter","text":"[prefix[snippet/]then[$:/xp/ui/ViewTemplate/title/caption]]"},"$:/templates/transclusion-snippet":{"title":"$:/templates/transclusion-snippet","text":"<$list filter=\"[all[current]!tag[Star]]\">\n\n<div class=\"xp-snippets-info\">\n\n! <$link><$transclude field=\"caption\"><$view field=\"title\"/></$transclude></$link><i class=\"tc-small-gap\"/><span class=\"tc-tiddler-controls\">\n<$list filter=\"$:/core/ui/Buttons/clone $:/core/ui/Buttons/delete $:/core/ui/Buttons/edit\" storyview=\"pop\" variable=\"listItem\"><$set name=\"tv-config-toolbar-class\" filter=\"[<tv-config-toolbar-class>] [<listItem>encodeuricomponent[]addprefix[tc-btn-]]\"><$transclude tiddler=<<listItem>>/></$set></$list><$list filter=\"[all[current]!tag<aggregationTag>]\" storyview=\"pop\" variable=\"ignore\"><$set name=\"tv-config-toolbar-class\" filter=\"[<tv-config-toolbar-class>] [[$:/core/ui/Buttons/close]encodeuricomponent[]addprefix[tc-btn-]]\"><$transclude tiddler=\"$:/core/ui/Buttons/close\"/></$set></$list></span>\n\n<div class=\"tc-tags-wrapper\" style=\"font-size:0.85em;\"><$list filter=\"[all[current]tags[]sort[]] -[<aggregationTag>]\" template=\"$:/core/ui/TagTemplate\" storyview=\"pop\"/></div>\n\n<$transclude/>\n\n</div>\n\n</$list>\n\n<$list filter=\"[all[current]tag[Star]]\">\n\n<div class=\"xp-snippets-info-star\">\n\n! <$link><$transclude field=\"caption\"><$view field=\"title\"/></$transclude></$link><i class=\"tc-small-gap\"/><span class=\"tc-tiddler-controls\">\n<$list filter=\"$:/core/ui/Buttons/clone $:/core/ui/Buttons/delete $:/core/ui/Buttons/edit\" storyview=\"pop\" variable=\"listItem\"><$set name=\"tv-config-toolbar-class\" filter=\"[<tv-config-toolbar-class>] [<listItem>encodeuricomponent[]addprefix[tc-btn-]]\"><$transclude tiddler=<<listItem>>/></$set></$list><$list filter=\"[all[current]!tag<aggregationTag>]\" storyview=\"pop\" variable=\"ignore\"><$set name=\"tv-config-toolbar-class\" filter=\"[<tv-config-toolbar-class>] [[$:/core/ui/Buttons/close]encodeuricomponent[]addprefix[tc-btn-]]\"><$transclude tiddler=\"$:/core/ui/Buttons/close\"/></$set></$list></span>\n\n<div class=\"tc-tags-wrapper\" style=\"font-size:0.85em;\"><$list filter=\"[all[current]tags[]sort[]] -[<aggregationTag>]\" template=\"$:/core/ui/TagTemplate\" storyview=\"pop\"/></div>\n\n<$transclude/>\n\n</div>\n\n</$list>"}}}